<!DOCTYPE html>
<html lang="it">
<head>
<meta http-equiv="content-language" content="it">
<meta name="googlebot" content="notranslate" />
<meta name="author" content="zera-mykerd">
<meta name='owner' content='zera-mykerd'>
<meta name='reply-to' content='zera0mykerd@gmail.com'>
<meta name='designer' content='zera-mykerd'>
<meta name="copyright" content="zera0mykerd" />

<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Cache-Control" content="no-cache">
<meta http-equiv="Expires" content="0">

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>&#x1F5C4;&#xFE0F; &#120236;&#120234;&#45;&#120331;&#120459;&#120458;&#120476;&#120462; &#128451;&#65039;&#128199;</title>
<link rel="shortcut icon" href="data:image/png;base64,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" />


     <style type="text/css">
/* Reset CSS */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Arial', sans-serif;
    background: linear-gradient(to right, #e0f7e8, #c6f7d9);
    color: #333;
    line-height: 1.6;
}

/* Header */
h1 {
    text-align: center;
    margin: 20px 0;
    color: #2f6d56;
    font-size: 2.5rem;
}

/* Search Input */
#searchInput {
    display: block;
    width: 100%;
    max-width: 400px;
    padding: 10px;
    margin: 20px auto;
    border: 2px solid #2f6d56;
    border-radius: 5px;
    transition: border-color 0.3s;
}

#searchInput:focus {
    border-color: #76c9b1;
    outline: none;
}

/* Form Styles */
#addRecordForm {
    background: white;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    max-width: 500px;
    margin: 20px auto;
    transition: box-shadow 0.3s;
}

#addRecordForm:hover {
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
}

input[type="text"],
input[type="date"],
input[type="tel"],
input[type="email"],
input[type="number"],
select {
    width: 100%;
    padding: 10px;
    margin: 10px 0;
    border: 2px solid #2f6d56;
    border-radius: 5px;
    transition: border-color 0.3s, background 0.3s;
}

input[type="text"]:focus,
input[type="date"]:focus,
input[type="tel"]:focus,
input[type="email"]:focus,
input[type="number"]:focus,
select:focus {
    border-color: #76c9b1;
    background: #f0fff4;
    outline: none;
}

button {
    background: linear-gradient(135deg, #4cae4c, #76c9b1);
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 5px;
    cursor: pointer;
    transition: background 0.3s, transform 0.2s;
}

button:hover {
    background: linear-gradient(135deg, #76c9b1, #4cae4c);
    transform: translateY(-2px);
}

/* Table Styles */
table {
    width: 100%;
    border-collapse: collapse;
    margin: 20px auto;
}

th, td {
    padding: 15px;
    text-align: left;
    border-bottom: 2px solid #e2e2e2;
    transition: background 0.3s;
}

th {
    background: #4cae4c;
    color: white;
    position: sticky;
    top: 0;
    z-index: 10;
}

tbody tr:hover {
    background: #f2f9f4;
}

td {
    background: PaleGreen;
}

/* Responsive Styles */
@media (max-width: 600px) {
    #addRecordForm {
        padding: 15px;
    }

    h1 {
        font-size: 2rem;
    }

    button {
        width: 100%;
    }
}

/* File Input Styles */
#fileInput {
    margin: 20px auto;
    display: block;
}

/* Centro la barra di ricerca e i pulsanti */
.container {
    text-align: center;
}

#loadFileButton,
#downloadJsonButton {
    display: block;
    margin: 10px auto;
}

#loadFileButton {
    background: linear-gradient(135deg, #2ab0ff, #7ed957);
    border: none;
    color: white;
    padding: 15px 30px;
    font-size: 18px;
    cursor: pointer;
    border-radius: 8px;
    transition: transform 0.3s, box-shadow 0.3s, background 0.3s;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
}

#loadFileButton:hover {
    transform: translateY(-3px);
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
    background: linear-gradient(135deg, #29a3db, #6fdc57);
}


/* Scrollbar Styles */
::-webkit-scrollbar {
    width: 12px; /* Width of the vertical scrollbar */
    height: 12px; /* Height of the horizontal scrollbar */
}

::-webkit-scrollbar-track {
    background: #e0f7e8; /* Background of the scrollbar track */
    border-radius: 10px;
}

::-webkit-scrollbar-thumb {
    background: #76c9b1; /* Color of the scrollbar handle */
    border-radius: 10px;
    transition: background 0.3s;
}

::-webkit-scrollbar-thumb:hover {
    background: #4cae4c; /* Color of the scrollbar handle on hover */
}

/* Animation on load */
body {
    animation: fadeIn 0.8s ease-in-out;
}

@keyframes fadeIn {
    from {
        opacity: 0;
    }
    to {
        opacity: 1;
    }
}

h1 {
    font-size: 3em;
    text-align: center;
    color: #007f7f; /* Acquamarine scuro */
    text-shadow: 
        2px 2px 4px rgba(60, 179, 113, 0.5), 
        0 0 25px rgba(0, 255, 255, 0.5),
        0 0 15px rgba(255, 165, 0, 0.7); /* Ombra arancione */
    background: linear-gradient(to right, #007f7f, #00bfff);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
}

@keyframes gradient {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
}


#amountOperations {
  display: flex;
  justify-content: center;
  align-items: center;
}

#amountOperations button {
  margin: 0 10px;
}


        #recordCount {
            background-color: #45A049;
            color: white; /* Colore del testo */
            padding: 15px 20px; /* Padding */
            border-radius: 8px; /* Angoli arrotondati */
            font-size: 20px; /* Dimensione del font */
            text-align: center; /* Allineamento del testo */
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2); /* Ombra */
            margin: 20px; /* Margine */
            transition: background-color 0.3s; /* Transizione per il cambio di colore */
			font-size: 32px;
			filter: brightness(75%);
        }

        #recordCount:hover {
            filter: brightness(100%); /* Colore di sfondo al passaggio del mouse */
        }

    </style>

</head>


<body>

<h3>&nbsp;</h3>

<center>
<svg width="324pt" height="170pt" viewBox="0 0 324 170" version="1.1"> <g id="#fcfdf9ff"> <path fill="#fcfdf9" opacity="1.00" d=" M 70.13 10.13 C 110.35 -0.48 153.78 0.40 193.89 11.13 C 211.25 14.93 221.31 30.48 231.16 43.73 C 239.71 41.79 251.84 46.63 249.50 57.21 C 269.47 66.01 295.86 61.91 311.11 80.88 C 318.36 88.98 312.14 99.39 313.41 108.39 C 323.58 111.24 323.54 129.12 312.81 130.94 C 311.35 137.89 304.75 140.95 298.96 142.91 C 291.22 168.73 250.80 169.68 240.40 145.42 C 218.11 146.01 195.86 146.42 173.57 145.56 C 169.63 159.27 156.76 170.24 141.99 168.54 C 126.40 170.33 114.58 156.76 111.24 142.79 C 93.10 140.99 75.22 137.08 57.12 135.13 C 52.65 149.37 34.91 152.36 22.60 147.47 C 12.71 142.40 9.84 130.14 9.22 119.94 C -4.02 107.34 4.03 84.92 14.60 72.64 C 16.88 62.43 27.78 58.50 30.97 48.98 C 39.04 32.16 51.25 15.32 70.13 10.13 M 66.79 17.35 C 49.15 23.76 39.33 41.99 32.44 58.29 C 25.67 62.57 20.30 68.49 18.08 76.32 C 9.96 85.51 1.91 103.00 10.65 113.23 C 11.64 113.63 12.64 114.04 13.63 114.44 C 13.79 126.44 16.96 146.05 33.00 144.41 C 43.24 146.53 51.79 138.80 53.65 129.14 C 74.29 132.25 94.87 135.80 115.58 138.39 C 117.66 147.69 121.87 157.87 131.24 161.86 C 147.40 168.52 167.57 158.52 169.24 140.37 C 194.22 140.90 219.21 140.72 244.19 140.35 C 250.90 165.70 292.00 162.72 295.76 136.79 C 302.39 139.40 307.86 132.75 307.82 126.56 C 314.84 127.60 317.07 120.69 315.20 115.12 C 265.57 118.87 215.49 117.62 165.71 116.63 C 163.61 119.91 165.08 123.64 166.31 126.92 C 159.44 125.74 160.39 111.74 168.00 112.44 C 214.77 113.37 261.59 113.32 308.35 112.00 C 308.33 108.62 307.95 105.25 307.06 101.98 C 311.98 94.96 310.34 83.66 302.38 79.59 C 293.11 72.43 281.55 69.19 270.09 67.75 C 259.20 68.58 250.38 61.38 239.89 59.63 C 249.21 55.21 242.11 46.78 234.17 48.06 C 233.43 49.92 232.70 51.78 231.96 53.64 C 224.40 43.70 218.19 31.94 208.09 24.42 C 203.64 18.10 195.24 16.89 188.38 14.61 C 148.85 5.85 105.15 3.16 66.79 17.35 Z" /> </g> <g id="#abe4b3ff"> <path fill="#abe4b3" opacity="1.00" d=" M 66.79 17.35 C 105.15 3.16 148.85 5.85 188.38 14.61 C 195.24 16.89 203.64 18.10 208.09 24.42 C 202.94 23.19 197.83 21.79 192.78 20.18 C 193.39 20.05 194.60 19.79 195.21 19.66 C 167.51 10.86 137.80 10.78 109.04 12.23 C 98.57 10.91 88.03 12.32 77.82 14.68 C 80.93 15.09 84.05 15.46 87.16 15.92 C 80.35 15.61 73.51 16.24 66.79 17.35 Z" /> <path fill="#abe4b3" opacity="1.00" d=" M 166.96 123.48 C 213.99 123.67 261.05 122.71 308.07 122.49 C 261.07 125.39 213.99 124.35 166.96 123.48 Z" /> </g> <g id="#fbfefaff"> <path fill="#fbfefa" opacity="1.00" d=" M 109.04 12.23 C 137.80 10.78 167.51 10.86 195.21 19.66 C 194.60 19.79 193.39 20.05 192.78 20.18 C 167.31 14.41 140.53 13.58 114.76 17.66 C 107.65 18.20 107.11 26.06 109.75 31.16 C 113.51 39.41 113.47 52.35 123.92 55.12 C 151.14 59.16 180.03 62.35 202.95 79.13 C 217.75 89.18 236.30 106.74 254.66 97.59 C 251.95 75.93 230.81 61.88 211.42 55.83 C 211.98 55.59 213.11 55.09 213.68 54.85 C 215.01 55.12 216.34 55.41 217.68 55.71 C 234.30 63.02 251.19 74.00 256.22 92.64 C 257.52 103.49 274.18 101.84 278.11 93.91 C 279.32 83.84 270.92 76.06 264.02 69.97 C 266.40 69.83 268.78 69.68 271.17 69.66 C 278.89 70.48 286.51 72.49 293.54 75.79 C 291.02 77.47 288.50 79.13 285.96 80.78 C 282.32 79.00 278.59 77.44 274.87 75.82 C 273.50 75.06 272.12 74.31 270.74 73.56 C 276.68 79.93 284.99 89.91 278.65 98.61 C 269.67 105.22 257.37 101.63 246.96 102.60 C 232.57 104.08 219.44 97.27 208.83 88.19 C 184.29 68.39 152.30 59.80 121.12 60.94 C 143.83 64.38 167.69 66.36 188.24 77.28 C 176.34 77.24 170.33 92.45 177.60 101.25 C 177.00 101.30 175.80 101.41 175.20 101.46 C 167.11 92.97 172.23 79.76 182.19 75.53 C 178.48 76.45 174.99 78.03 171.78 80.08 C 160.81 75.85 149.49 72.25 137.60 72.14 C 142.79 69.14 148.97 69.39 154.56 67.61 C 140.03 65.60 125.30 65.95 110.70 64.84 C 110.70 64.09 110.70 62.59 110.70 61.84 C 111.64 50.16 105.64 39.11 102.99 27.89 C 101.47 20.42 94.28 16.41 87.16 15.92 C 84.05 15.46 80.93 15.09 77.82 14.68 C 88.03 12.32 98.57 10.91 109.04 12.23 Z" /> <path fill="#fbfefa" opacity="1.00" d=" M 117.96 87.85 C 121.82 80.47 131.77 75.93 138.62 82.36 C 151.70 94.52 157.18 115.18 153.02 132.18 C 150.37 115.90 148.85 94.83 131.97 86.62 C 127.33 84.35 122.40 86.11 117.96 87.85 Z" /> </g> <g id="#01834cff"> <path fill="#01834c" opacity="1.00" d=" M 114.76 17.66 C 140.53 13.58 167.31 14.41 192.78 20.18 C 197.83 21.79 202.94 23.19 208.09 24.42 C 218.19 31.94 224.40 43.70 231.96 53.64 C 232.94 55.23 233.86 56.85 234.79 58.46 C 229.10 57.42 223.43 56.31 217.68 55.71 C 216.34 55.41 215.01 55.12 213.68 54.85 C 183.99 49.67 153.75 54.91 123.92 55.12 C 113.47 52.35 113.51 39.41 109.75 31.16 C 107.11 26.06 107.65 18.20 114.76 17.66 M 179.00 29.31 C 180.06 35.98 182.87 42.20 184.94 48.60 C 197.81 42.19 210.74 49.98 223.25 52.89 C 220.80 47.05 216.12 42.59 212.45 37.54 C 205.88 25.89 190.18 28.83 179.00 29.31 M 113.09 31.15 C 114.35 35.39 115.80 39.58 117.35 43.74 C 125.17 46.60 135.75 44.55 135.46 34.59 C 128.70 31.22 120.53 31.59 113.09 31.15 M 148.64 44.42 C 157.05 47.16 166.56 47.95 175.51 48.39 C 174.26 42.90 172.36 37.60 170.62 32.25 C 161.55 30.30 150.13 34.87 148.64 44.42 Z" /> </g> <g id="#04854dff"> <path fill="#04854d" opacity="1.00" d=" M 66.79 17.35 C 73.51 16.24 80.35 15.61 87.16 15.92 C 94.28 16.41 101.47 20.42 102.99 27.89 C 105.64 39.11 111.64 50.16 110.70 61.84 C 106.05 84.58 109.30 107.94 106.64 130.87 C 86.92 128.91 67.39 125.23 47.80 122.21 C 42.16 121.90 41.46 115.45 41.15 111.07 C 40.66 100.37 39.38 89.72 36.11 79.49 C 41.84 90.30 41.49 102.94 43.33 114.73 C 44.25 119.61 50.13 119.17 53.92 119.91 C 52.47 103.73 51.63 87.37 54.45 71.27 C 58.43 71.82 62.43 72.28 66.40 72.87 C 62.88 73.68 59.27 73.35 55.77 72.61 C 54.00 88.38 53.90 104.36 56.06 120.09 C 71.00 122.64 86.01 124.93 101.04 126.75 C 105.80 127.54 105.94 121.34 106.22 118.08 C 105.40 100.55 104.17 82.72 107.66 65.38 C 110.92 53.64 104.71 42.22 102.17 30.97 C 98.74 13.65 75.70 16.18 63.26 21.25 C 51.72 26.31 45.40 37.89 38.76 47.91 C 36.33 51.88 34.31 56.08 32.05 60.14 C 32.15 59.68 32.34 58.75 32.44 58.29 C 39.33 41.99 49.15 23.76 66.79 17.35 Z" /> </g> <g id="#daf0d0ff"> <path fill="#daf0d0" opacity="1.00" d=" M 63.26 21.25 C 75.70 16.18 98.74 13.65 102.17 30.97 C 104.71 42.22 110.92 53.64 107.66 65.38 C 91.15 63.92 74.56 64.41 58.04 63.41 C 58.94 59.47 62.43 58.34 66.10 58.19 C 60.95 54.05 57.08 58.30 55.21 63.18 C 46.42 64.44 37.44 64.25 28.62 65.48 C 35.74 59.36 45.62 59.74 54.37 58.35 C 46.93 59.03 35.31 58.74 38.76 47.91 C 45.40 37.89 51.72 26.31 63.26 21.25 M 67.07 42.01 C 66.62 46.04 62.24 52.83 67.01 55.19 C 77.81 55.51 88.67 55.77 99.48 55.36 C 92.99 53.07 78.67 57.07 80.18 46.28 C 81.92 45.59 83.67 44.90 85.41 44.20 C 80.26 44.19 75.10 44.28 69.95 44.19 C 70.76 39.49 72.20 34.93 73.48 30.33 C 81.97 29.84 90.47 29.94 98.97 30.30 C 100.53 34.60 102.04 38.95 102.83 43.47 C 101.67 43.63 100.51 43.78 99.36 43.93 C 100.66 46.23 101.84 48.60 103.06 50.95 C 106.72 39.88 99.32 17.46 82.99 20.52 C 69.82 17.79 70.23 33.60 67.07 42.01 M 40.79 52.96 C 47.83 58.72 63.77 56.69 62.62 44.21 C 57.02 45.10 51.38 45.71 45.73 46.14 C 50.09 39.17 56.11 31.07 65.19 31.00 C 65.27 31.85 65.41 33.54 65.48 34.39 C 66.74 30.61 67.94 26.78 68.40 22.81 C 53.99 25.15 43.81 39.55 40.79 52.96 Z" /> <path fill="#daf0d0" opacity="1.00" d=" M 148.64 44.42 C 150.13 34.87 161.55 30.30 170.62 32.25 C 172.36 37.60 174.26 42.90 175.51 48.39 C 166.56 47.95 157.05 47.16 148.64 44.42 Z" /> </g> <g id="#01844dff"> <path fill="#01844d" opacity="1.00" d=" M 67.07 42.01 C 70.23 33.60 69.82 17.79 82.99 20.52 C 99.32 17.46 106.72 39.88 103.06 50.95 C 101.84 48.60 100.66 46.23 99.36 43.93 C 100.51 43.78 101.67 43.63 102.83 43.47 C 102.04 38.95 100.53 34.60 98.97 30.30 C 90.47 29.94 81.97 29.84 73.48 30.33 C 72.20 34.93 70.76 39.49 69.95 44.19 C 75.10 44.28 80.26 44.19 85.41 44.20 C 83.67 44.90 81.92 45.59 80.18 46.28 C 78.67 57.07 92.99 53.07 99.48 55.36 C 88.67 55.77 77.81 55.51 67.01 55.19 C 62.24 52.83 66.62 46.04 67.07 42.01 Z" /> </g> <g id="#03834eff"> <path fill="#03834e" opacity="1.00" d=" M 40.79 52.96 C 43.81 39.55 53.99 25.15 68.40 22.81 C 67.94 26.78 66.74 30.61 65.48 34.39 C 65.41 33.54 65.27 31.85 65.19 31.00 C 56.11 31.07 50.09 39.17 45.73 46.14 C 51.38 45.71 57.02 45.10 62.62 44.21 C 63.77 56.69 47.83 58.72 40.79 52.96 Z" /> </g> <g id="#daefd0ff"> <path fill="#daefd0" opacity="1.00" d=" M 179.00 29.31 C 190.18 28.83 205.88 25.89 212.45 37.54 C 216.12 42.59 220.80 47.05 223.25 52.89 C 210.74 49.98 197.81 42.19 184.94 48.60 C 182.87 42.20 180.06 35.98 179.00 29.31 Z" /> </g> <g id="#daf0cfff"> <path fill="#daf0cf" opacity="1.00" d=" M 113.09 31.15 C 120.53 31.59 128.70 31.22 135.46 34.59 C 135.75 44.55 125.17 46.60 117.35 43.74 C 115.80 39.58 114.35 35.39 113.09 31.15 Z" /> </g> <g id="#a6e6adff"> <path fill="#a6e6ad" opacity="1.00" d=" M 32.05 60.14 C 34.31 56.08 36.33 51.88 38.76 47.91 C 35.31 58.74 46.93 59.03 54.37 58.35 C 45.62 59.74 35.74 59.36 28.62 65.48 C 37.44 64.25 46.42 64.44 55.21 63.18 C 57.08 58.30 60.95 54.05 66.10 58.19 C 62.43 58.34 58.94 59.47 58.04 63.41 C 74.56 64.41 91.15 63.92 107.66 65.38 C 104.17 82.72 105.40 100.55 106.22 118.08 C 105.94 121.34 105.80 127.54 101.04 126.75 C 86.01 124.93 71.00 122.64 56.06 120.09 C 53.90 104.36 54.00 88.38 55.77 72.61 C 59.27 73.35 62.88 73.68 66.40 72.87 C 62.43 72.28 58.43 71.82 54.45 71.27 C 51.63 87.37 52.47 103.73 53.92 119.91 C 50.13 119.17 44.25 119.61 43.33 114.73 C 41.49 102.94 41.84 90.30 36.11 79.49 C 39.38 89.72 40.66 100.37 41.15 111.07 C 41.46 115.45 42.16 121.90 47.80 122.21 C 67.39 125.23 86.92 128.91 106.64 130.87 C 109.30 107.94 106.05 84.58 110.70 61.84 C 110.70 62.59 110.70 64.09 110.70 64.84 C 125.30 65.95 140.03 65.60 154.56 67.61 C 148.97 69.39 142.79 69.14 137.60 72.14 C 149.49 72.25 160.81 75.85 171.78 80.08 C 174.99 78.03 178.48 76.45 182.19 75.53 C 172.23 79.76 167.11 92.97 175.20 101.46 C 175.80 101.41 177.00 101.30 177.60 101.25 C 188.59 114.14 205.92 97.43 198.25 84.24 C 207.16 89.63 214.72 97.09 224.09 101.76 C 236.26 107.39 250.03 105.54 263.02 105.73 C 269.84 105.68 278.61 105.02 281.90 97.96 C 285.21 89.79 280.09 81.79 274.87 75.82 C 278.59 77.44 282.32 79.00 285.96 80.78 C 288.50 79.13 291.02 77.47 293.54 75.79 C 295.15 76.54 296.75 77.31 298.35 78.09 C 280.02 82.29 291.19 115.98 307.06 101.98 C 307.95 105.25 308.33 108.62 308.35 112.00 C 261.59 113.32 214.77 113.37 168.00 112.44 C 160.39 111.74 159.44 125.74 166.31 126.92 C 181.32 130.46 197.00 127.66 212.26 129.19 C 212.98 131.17 213.72 133.13 214.48 135.10 C 217.86 134.87 219.57 132.09 220.78 129.26 C 244.52 128.75 268.30 128.73 292.01 127.76 C 293.37 129.38 294.34 131.28 295.42 133.09 C 297.88 131.91 299.55 129.76 300.76 127.37 C 303.11 127.06 305.46 126.80 307.82 126.56 C 307.86 132.75 302.39 139.40 295.76 136.79 C 255.54 137.19 215.24 139.52 174.96 138.49 C 167.52 137.97 157.17 140.29 153.02 132.18 C 157.18 115.18 151.70 94.52 138.62 82.36 C 131.77 75.93 121.82 80.47 117.96 87.85 C 122.40 86.11 127.33 84.35 131.97 86.62 C 109.90 90.14 110.21 118.38 110.54 135.73 C 86.12 132.12 61.56 128.45 37.24 124.83 C 30.04 113.07 37.03 92.06 21.99 84.54 C 10.17 87.33 11.37 103.58 10.65 113.23 C 1.91 103.00 9.96 85.51 18.08 76.32 C 20.30 68.49 25.67 62.57 32.44 58.29 C 32.34 58.75 32.15 59.68 32.05 60.14 Z" /> </g> <g id="#a6e5aefe"> <path fill="#a6e5ae" opacity="1.00" d=" M 234.17 48.06 C 242.11 46.78 249.21 55.21 239.89 59.63 C 250.38 61.38 259.20 68.58 270.09 67.75 C 267.84 67.76 265.60 67.93 263.37 68.15 C 265.94 68.80 268.54 69.33 271.17 69.66 C 268.78 69.68 266.40 69.83 264.02 69.97 C 270.92 76.06 279.32 83.84 278.11 93.91 C 274.18 101.84 257.52 103.49 256.22 92.64 C 251.19 74.00 234.30 63.02 217.68 55.71 C 223.43 56.31 229.10 57.42 234.79 58.46 C 233.86 56.85 232.94 55.23 231.96 53.64 C 232.70 51.78 233.43 49.92 234.17 48.06 Z" /> </g> <g id="#a7e6adff"> <path fill="#a7e6ad" opacity="1.00" d=" M 123.92 55.12 C 153.75 54.91 183.99 49.67 213.68 54.85 C 213.11 55.09 211.98 55.59 211.42 55.83 C 209.55 55.62 207.68 55.38 205.81 55.15 C 227.36 61.07 247.88 75.38 254.66 97.59 C 236.30 106.74 217.75 89.18 202.95 79.13 C 180.03 62.35 151.14 59.16 123.92 55.12 Z" /> </g> <g id="#0a8051ff"> <path fill="#0a8051" opacity="1.00" d=" M 205.81 55.15 C 207.68 55.38 209.55 55.62 211.42 55.83 C 230.81 61.88 251.95 75.93 254.66 97.59 C 247.88 75.38 227.36 61.07 205.81 55.15 Z" /> <path fill="#0a8051" opacity="1.00" d=" M 22.31 100.32 C 33.69 103.57 34.00 128.13 24.01 133.57 C 14.86 126.72 15.07 108.69 22.31 100.32 M 24.05 129.04 C 31.62 124.44 30.63 109.91 24.05 104.22 C 16.42 109.11 16.73 124.28 24.05 129.04 Z" /> </g> <g id="#068450ff"> <path fill="#068450" opacity="1.00" d=" M 121.12 60.94 C 152.30 59.80 184.29 68.39 208.83 88.19 C 219.44 97.27 232.57 104.08 246.96 102.60 C 257.37 101.63 269.67 105.22 278.65 98.61 C 284.99 89.91 276.68 79.93 270.74 73.56 C 272.12 74.31 273.50 75.06 274.87 75.82 C 280.09 81.79 285.21 89.79 281.90 97.96 C 278.61 105.02 269.84 105.68 263.02 105.73 C 250.03 105.54 236.26 107.39 224.09 101.76 C 214.72 97.09 207.16 89.63 198.25 84.24 C 205.92 97.43 188.59 114.14 177.60 101.25 C 170.33 92.45 176.34 77.24 188.24 77.28 C 167.69 66.36 143.83 64.38 121.12 60.94 M 183.27 81.22 C 171.89 85.95 177.23 106.47 189.93 102.96 C 203.30 99.43 196.65 75.73 183.27 81.22 Z" /> </g> <g id="#07834eff"> <path fill="#07834e" opacity="1.00" d=" M 263.37 68.15 C 265.60 67.93 267.84 67.76 270.09 67.75 C 281.55 69.19 293.11 72.43 302.38 79.59 C 310.34 83.66 311.98 94.96 307.06 101.98 C 291.19 115.98 280.02 82.29 298.35 78.09 C 296.75 77.31 295.15 76.54 293.54 75.79 C 286.51 72.49 278.89 70.48 271.17 69.66 C 268.54 69.33 265.94 68.80 263.37 68.15 M 299.20 81.38 C 287.37 81.87 287.92 103.20 299.99 102.82 C 311.15 101.79 309.95 82.32 299.20 81.38 Z" /> </g> <g id="#fdfffcff"> <path fill="#fdfffc" opacity="1.00" d=" M 183.27 81.22 C 196.65 75.73 203.30 99.43 189.93 102.96 C 177.23 106.47 171.89 85.95 183.27 81.22 Z" /> </g> <g id="#fefdfaff"> <path fill="#fefdfa" opacity="1.00" d=" M 299.20 81.38 C 309.95 82.32 311.15 101.79 299.99 102.82 C 287.92 103.20 287.37 81.87 299.20 81.38 Z" /> </g> <g id="#02834dff"> <path fill="#02834d" opacity="1.00" d=" M 10.65 113.23 C 11.37 103.58 10.17 87.33 21.99 84.54 C 37.03 92.06 30.04 113.07 37.24 124.83 C 61.56 128.45 86.12 132.12 110.54 135.73 C 110.21 118.38 109.90 90.14 131.97 86.62 C 148.85 94.83 150.37 115.90 153.02 132.18 C 157.17 140.29 167.52 137.97 174.96 138.49 C 215.24 139.52 255.54 137.19 295.76 136.79 C 292.00 162.72 250.90 165.70 244.19 140.35 C 219.21 140.72 194.22 140.90 169.24 140.37 C 167.57 158.52 147.40 168.52 131.24 161.86 C 121.87 157.87 117.66 147.69 115.58 138.39 C 94.87 135.80 74.29 132.25 53.65 129.14 C 51.79 138.80 43.24 146.53 33.00 144.41 C 16.96 146.05 13.79 126.44 13.63 114.44 C 12.64 114.04 11.64 113.63 10.65 113.23 M 22.45 96.54 C 12.75 105.54 15.13 122.81 20.02 133.99 C 25.69 142.76 32.35 130.11 31.72 124.07 C 31.75 115.14 33.41 98.97 22.45 96.54 M 130.36 103.56 C 113.63 112.17 115.09 139.73 126.57 152.42 C 137.09 160.74 146.12 145.41 146.30 136.02 C 147.57 124.17 145.15 104.72 130.36 103.56 Z" /> </g> <g id="#f7fdf6ff"> <path fill="#f7fdf6" opacity="1.00" d=" M 22.45 96.54 C 33.41 98.97 31.75 115.14 31.72 124.07 C 32.35 130.11 25.69 142.76 20.02 133.99 C 15.13 122.81 12.75 105.54 22.45 96.54 M 22.31 100.32 C 15.07 108.69 14.86 126.72 24.01 133.57 C 34.00 128.13 33.69 103.57 22.31 100.32 Z" /> </g> <g id="#f7fef8ff"> <path fill="#f7fef8" opacity="1.00" d=" M 130.36 103.56 C 145.15 104.72 147.57 124.17 146.30 136.02 C 146.12 145.41 137.09 160.74 126.57 152.42 C 115.09 139.73 113.63 112.17 130.36 103.56 M 129.27 108.30 C 116.81 117.72 117.38 143.17 131.62 150.50 C 149.75 147.64 148.47 107.67 129.27 108.30 Z" /> </g> <g id="#ccebceff"> <path fill="#ccebce" opacity="1.00" d=" M 24.05 129.04 C 16.73 124.28 16.42 109.11 24.05 104.22 C 30.63 109.91 31.62 124.44 24.05 129.04 Z" /> </g> <g id="#07814fff"> <path fill="#07814f" opacity="1.00" d=" M 129.27 108.30 C 148.47 107.67 149.75 147.64 131.62 150.50 C 117.38 143.17 116.81 117.72 129.27 108.30 M 130.20 114.11 C 120.47 120.40 120.99 139.22 131.35 144.59 C 145.70 143.71 144.74 113.65 130.20 114.11 Z" /> </g> <g id="#cfedd0ff"> <path fill="#cfedd0" opacity="1.00" d=" M 130.20 114.11 C 144.74 113.65 145.70 143.71 131.35 144.59 C 120.99 139.22 120.47 120.40 130.20 114.11 Z" /> </g> <g id="#03844eff"> <path fill="#03844e" opacity="1.00" d=" M 165.71 116.63 C 215.49 117.62 265.57 118.87 315.20 115.12 C 317.07 120.69 314.84 127.60 307.82 126.56 C 305.46 126.80 303.11 127.06 300.76 127.37 C 299.55 129.76 297.88 131.91 295.42 133.09 C 294.34 131.28 293.37 129.38 292.01 127.76 C 268.30 128.73 244.52 128.75 220.78 129.26 C 219.57 132.09 217.86 134.87 214.48 135.10 C 213.72 133.13 212.98 131.17 212.26 129.19 C 197.00 127.66 181.32 130.46 166.31 126.92 C 165.08 123.64 163.61 119.91 165.71 116.63 M 166.96 123.48 C 213.99 124.35 261.07 125.39 308.07 122.49 C 261.05 122.71 213.99 123.67 166.96 123.48 Z" /> </g> </svg> 
</center>

    <h1>Gestione Clienti Autoscuole</h1>

    <form id="addRecordForm">
        <!-- Campi esistenti -->
	    <input type="text" id="newId" placeholder="ID" required>
        <input type="text" id="firstName" placeholder="Nome" required>
        <input type="text" id="lastName" placeholder="Cognome" required>
        <input type="date" id="birthDate" placeholder="Data di nascita" required>
        <input type="text" id="residence" placeholder="Residenza" required>
        <input type="tel" id="phone" placeholder="Numero di telefono" required pattern="[0-9]*">
        <input type="email" id="email" placeholder="Email" required>
        <input type="text" id="licenseType" placeholder="Tipo di patente" required>
        
        <select id="courseStatus" required>
            <option value="" disabled selected>Seleziona stato del corso</option>
            <option value="Superato">Superato</option>
            <option value="Non superato">Non superato</option>
            <option value="In frequentazione">In frequentazione</option>
        </select>
        
        <input type="text" id="examResults" placeholder="Risultati esami (0-30 Errori)" required pattern="^(3[0]|[0-2]?[0-9])\sErrori$">
        
        <select id="paymentStatus" required>
            <option value="" disabled selected>Seleziona stato pagamento</option>
            <option value="Saldato">Saldato</option>
            <option value="Non saldato">Non saldato</option>
        </select>

        <input type="date" id="startDate" placeholder="Data di inizio" required>
        
        <!-- Nuovo campo per "Da versare" -->
        <input type="number" id="amountDue" placeholder="Da versare" step="0.01" required>
		<br>
	    <!-- Sezione per le operazioni di aggiunta/sottrazione -->
    <div id="amountOperations">
        <input type="number" id="amountToAddSubtract" step="0.01" placeholder="Importo">
        <button id="addAmount">+</button>
        <button id="subtractAmount">-</button>
    </div>
        <br>
        <button type="submit">Aggiungi Cliente</button>
    </form>



    <input type="file" id="fileInput" accept=".json">
    <button id="loadFileButton">Carica JSON</button>

    <button id="downloadJsonButton">Scarica JSON</button>
    <br><br>
    <input type="text" id="searchInput" placeholder="Cerca..." onkeyup="advancedFilterTable()">
    <div id="recordCount">Numero totale di record:<strong> 0 </strong></div>
    <table id="dataTable">
        <thead>
            <tr>
                <th>ID</th>
                <th>Nome</th>
                <th>Cognome</th>
                <th>Data di nascita</th>
                <th>Residenza</th>
                <th>Numero di telefono</th>
                <th>Email</th>
                <th>Tipo di patente</th>
                <th>Stato del corso</th>
                <th>Risultati esami</th>
                <th>Stato pagamento</th>
                <th>Data di inizio</th>
                <th>Da versare</th>
                <th>Azioni</th>
            </tr>
        </thead>
        <tbody id="dataTableBody">
        </tbody>
    </table>




<script type="text/javascript">



const dataTableBody = document.getElementById('dataTableBody');
const addRecordForm = document.getElementById('addRecordForm');
const fileInput = document.getElementById('fileInput');

console.log('Inizializzazione del codice...');

// Funzione di sanitizzazione
function sanitizeInput(input) {
    const element = document.createElement('div');
    element.innerText = input; // Usa innerText per evitare XSS
    return element.innerHTML; // Ritorna il valore sanitizzato
}

// Funzione di validazione
function validateInput() {
    console.log('Inizio validazione input...');
    const email = sanitizeInput(document.getElementById('email').value);
    const phone = sanitizeInput(document.getElementById('phone').value);
    const paymentStatus = sanitizeInput(document.getElementById('paymentStatus').value);

    const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/; // Regex per email

    // Validazione dell'email
    if (!emailPattern.test(email)) {
        alert('Inserisci un indirizzo email valido!');
        console.log('Email non valida:', email);
        return false;
    }
    console.log('Email valida:', email);

    // Validazione del numero di telefono
    if (!phone) {
        alert('Inserisci un numero di telefono valido!');
        console.log('Numero di telefono non valido:', phone);
        return false;
    }
    console.log('Numero di telefono valido:', phone);

    // Validazione dello stato di pagamento
    if (!paymentStatus) {
        alert('Seleziona uno stato di pagamento!');
        console.log('Stato di pagamento non selezionato:', paymentStatus);
        return false;
    }
    console.log('Stato di pagamento selezionato:', paymentStatus);

    console.log('Tutti i controlli sono passati.');
    return true; // Tutti i controlli sono passati
}

        function updateRecordCount() {
            const tbody = document.getElementById('dataTableBody');
            const recordCount = tbody.rows.length;
            document.getElementById('recordCount').innerText = `Numero totale di record: ${recordCount}`;
        }

// Aggiungi un record dal modulo
addRecordForm.addEventListener('submit', (e) => {
    e.preventDefault();
    console.log('Modulo inviato.');

    // Validazione
    if (!validateInput()) {
        console.log('Validazione fallita, uscita.');
        return; // Se la validazione fallisce, esci
    }

    const newId = sanitizeInput(document.getElementById('newId').value); // Prendi l'ID dal campo
    const existingRow = Array.from(dataTableBody.rows).find(row => row.cells[0].innerText === newId);

    try {
        console.log('Validazione superata, procedendo con l\'aggiunta del record...');

        const firstName = sanitizeInput(document.getElementById('firstName').value) || 'none';
        const lastName = sanitizeInput(document.getElementById('lastName').value) || 'none';
        const birthDate = sanitizeInput(document.getElementById('birthDate').value) || 'none';
        const residence = sanitizeInput(document.getElementById('residence').value) || 'none';
        const phone = sanitizeInput(document.getElementById('phone').value) || 'none';
        const email = sanitizeInput(document.getElementById('email').value) || 'none';
        const licenseType = sanitizeInput(document.getElementById('licenseType').value) || 'none';
        const courseStatus = sanitizeInput(document.getElementById('courseStatus').value) || 'none';
        const examResults = sanitizeInput(document.getElementById('examResults').value) || 'none';
        const paymentStatus = sanitizeInput(document.getElementById('paymentStatus').value) || 'none';
        const startDate = sanitizeInput(document.getElementById('startDate').value) || 'none';
        const amountDue = sanitizeInput(document.getElementById('amountDue').value) || '0'; // Nuovo campo aggiunto

        if (existingRow) {
            // Sovrascrivi il record esistente
            existingRow.cells[1].innerText = firstName;
            existingRow.cells[2].innerText = lastName;
            existingRow.cells[3].innerText = birthDate;
            existingRow.cells[4].innerText = residence;
            existingRow.cells[5].innerText = phone;
            existingRow.cells[6].innerText = email;
            existingRow.cells[7].innerText = licenseType;
            existingRow.cells[8].innerText = courseStatus;
            existingRow.cells[9].innerText = examResults;
            existingRow.cells[10].innerText = paymentStatus;
            existingRow.cells[11].innerText = startDate;
            existingRow.cells[12].innerText = amountDue;
            console.log('Record esistente aggiornato.');
        } else {
            // Aggiungi la nuova riga alla tabella
            const newRow = '<tr>' +
                '<td class="editable">' + newId + '</td>' +
                '<td class="editable">' + firstName + '</td>' +
                '<td class="editable">' + lastName + '</td>' +
                '<td class="editable">' + birthDate + '</td>' +
                '<td class="editable">' + residence + '</td>' +
                '<td class="editable">' + phone + '</td>' +
                '<td class="editable">' + email + '</td>' +
                '<td class="editable">' + licenseType + '</td>' +
                '<td class="editable">' + courseStatus + '</td>' +
                '<td class="editable">' + examResults + '</td>' +
                '<td class="editable">' + paymentStatus + '</td>' +
                '<td class="editable">' + startDate + '</td>' +
                '<td class="editable amountDue">' + amountDue + '</td>' + // Aggiunto campo amountDue
                '<td><button class="deleteButton">Elimina</button></td>' +
                '</tr>';

            dataTableBody.insertAdjacentHTML('beforeend', newRow);
            console.log('Nuova riga aggiunta alla tabella.');
        }

        addEditableFunctionality();
        addDeleteFunctionality();
        addRecordForm.reset();
		updateRecordCount();
        console.log('Modulo resettato dopo l\'aggiunta del record.');
    } catch (error) {
        console.error('Errore durante l\'aggiunta del record:', error);
        alert('Si è verificato un errore durante l\'aggiunta del record. Controlla la console per maggiori dettagli.');
    }
});



// Funzione per il controllo input numerico
document.getElementById('phone').addEventListener('input', (e) => {
    e.target.value = e.target.value.replace(/[^0-9+]/g, ''); // Permetti solo numeri e +
    console.log('Input numero di telefono modificato:', e.target.value);
});



// Aggiungi la funzionalità di modifica
function addEditableFunctionality() {
    console.log('Aggiunta funzionalità di modifica...');
    const editableCells = document.querySelectorAll('.editable');
    const rows = dataTableBody.querySelectorAll('tr');

    // Gestione del doppio clic sulle celle per la modifica
    editableCells.forEach(cell => {
        cell.addEventListener('dblclick', () => {
            console.log('Cella modificabile doppio cliccata:', cell);
            const originalText = cell.innerText;
            const input = document.createElement('input');
            input.value = originalText;
            cell.innerHTML = '';
            cell.appendChild(input);
			updateRecordCount();
            input.focus();

            let isEditing = true; // Flag per sapere se si sta modificando

            const onBlurOrEnter = (e) => {
                if (isEditing && (e.type === 'blur' || e.key === 'Enter')) {
                    isEditing = false; // Imposta il flag su false
                    cell.innerHTML = sanitizeInput(input.value) || originalText;
                    console.log('Valore della cella modificato:', cell.innerText);

                    // Rimuovi gli eventi per evitare leak
                    input.removeEventListener('blur', onBlurOrEnter);
                    input.removeEventListener('keypress', onBlurOrEnter);
                }
            };

            input.addEventListener('blur', onBlurOrEnter);
            input.addEventListener('keypress', onBlurOrEnter);
        });
    });

    // Gestione del clic sulla riga per precompilare il modulo
    rows.forEach(row => {
        row.addEventListener('click', () => {
            const cells = row.querySelectorAll('td');
			document.getElementById('newId').value = cells[0].innerText; // ID
            document.getElementById('firstName').value = cells[1].innerText; // Nome
            document.getElementById('lastName').value = cells[2].innerText; // Cognome
            document.getElementById('birthDate').value = cells[3].innerText; // Data di nascita
            document.getElementById('residence').value = cells[4].innerText; // Residenza
            document.getElementById('phone').value = cells[5].innerText; // Telefono
            document.getElementById('email').value = cells[6].innerText; // Email
            document.getElementById('licenseType').value = cells[7].innerText; // Tipo di patente
            document.getElementById('courseStatus').value = cells[8].innerText; // Stato del corso
            document.getElementById('examResults').value = cells[9].innerText; // Risultati esami
            document.getElementById('paymentStatus').value = cells[10].innerText; // Stato pagamento
            document.getElementById('startDate').value = cells[11].innerText; // Data di inizio
            document.getElementById('amountDue').value = cells[12].innerText; // Da versare
        });
    });
}



document.getElementById('addAmount').addEventListener('click', (e) => {
    e.preventDefault(); // Previene l'invio del modulo
    const amount = parseFloat(document.getElementById('amountToAddSubtract').value) || 0;
    const currentAmount = parseFloat(document.getElementById('amountDue').value) || 0;
    document.getElementById('amountDue').value = (currentAmount + amount).toFixed(2);
});

document.getElementById('subtractAmount').addEventListener('click', (e) => {
    e.preventDefault(); // Previene l'invio del modulo
    const amount = parseFloat(document.getElementById('amountToAddSubtract').value) || 0;
    const currentAmount = parseFloat(document.getElementById('amountDue').value) || 0;
    document.getElementById('amountDue').value = (currentAmount - amount).toFixed(2);
});


// Aggiungi la funzionalità di eliminazione
function addDeleteFunctionality() {
    console.log('Aggiunta funzionalità di eliminazione...');
    const deleteButtons = document.querySelectorAll('.deleteButton');

    deleteButtons.forEach(button => {
        button.addEventListener('click', (e) => {
            const row = e.target.closest('tr');
            console.log('Eliminazione riga:', row);
            row.remove();
            updateRowIds();
			updateRecordCount();
        });
    });
}

// Aggiorna gli ID dopo l'eliminazione
function updateRowIds() {
    console.log('Aggiornamento ID righe dopo eliminazione...');
    const rows = dataTableBody.querySelectorAll('tr');
    rows.forEach((row, index) => {
        row.cells[0].innerText = index + 1; // Aggiorna ID
        console.log('ID aggiornato per riga:', index + 1);
    });
}

let debounceTimer;

document.getElementById('searchInput').addEventListener('input', () => {
    clearTimeout(debounceTimer);
    debounceTimer = setTimeout(() => {
        console.log('Attivazione della ricerca avanzata...');
        advancedFilterTable();
    }, 300); // Aspetta 300ms dopo l'ultima digitazione
});

// Funzione di ricerca avanzata
function advancedFilterTable() {
    const searchInput = sanitizeInput(document.getElementById('searchInput').value.toLowerCase());
    const searchTerms = searchInput.split(' '); // Divide l'input in termini
    console.log('Termini di ricerca:', searchTerms);

    const rows = dataTableBody.getElementsByTagName('tr');

    requestAnimationFrame(() => {
        for (let i = 0; i < rows.length; i++) {
            const cells = rows[i].getElementsByTagName('td');
            let match = true;

            // Controlla ogni termine di ricerca
            for (let term of searchTerms) {
                let termMatch = false;
                console.log('Controllo termine di ricerca:', term);

                // Controlla tutte le celle della riga
                for (let j = 0; j < cells.length; j++) {
                    if (cells[j].innerText.toLowerCase().includes(term)) {
                        termMatch = true;
                        console.log('Corrispondenza trovata nella cella:', cells[j].innerText);
                        break; // Termina il ciclo se trovi una corrispondenza
                    }
                }

                // Se il termine non corrisponde a nessuna cella, esci dal ciclo
                if (!termMatch) {
                    match = false;
                    console.log('Termine non corrisponde a nessuna cella per riga:', i);
                    break;
                }
            }

            rows[i].style.display = match ? '' : 'none';
            console.log('Riga', i, 'visibile:', match);
        }
    });
}

// Carica un file JSON
document.getElementById('loadFileButton').addEventListener('click', () => {
    const file = fileInput.files[0];
    if (!file) {
        alert('Seleziona un file JSON!');
        console.log('Nessun file selezionato.');
        return;
    }

    console.log('File selezionato:', file.name);
    const reader = new FileReader();
    reader.onload = function(event) {
        try {
            const data = JSON.parse(event.target.result);
            console.log('Dati JSON caricati:', data);
            dataTableBody.innerHTML = ''; // Pulisci la tabella

            data.forEach(record => {
                const newRow = '<tr>' +
                    '<td class="editable">' + sanitizeInput(record.id) + '</td>' +
                    '<td class="editable">' + sanitizeInput(record.firstName) + '</td>' +
                    '<td class="editable">' + sanitizeInput(record.lastName) + '</td>' +
                    '<td class="editable">' + sanitizeInput(record.birthDate) + '</td>' +
                    '<td class="editable">' + sanitizeInput(record.residence) + '</td>' +
                    '<td class="editable">' + sanitizeInput(record.phone) + '</td>' +
                    '<td class="editable">' + sanitizeInput(record.email) + '</td>' +
                    '<td class="editable">' + sanitizeInput(record.licenseType) + '</td>' +
                    '<td class="editable">' + sanitizeInput(record.courseStatus) + '</td>' +
                    '<td class="editable">' + sanitizeInput(record.examResults) + '</td>' +
                    '<td class="editable">' + sanitizeInput(record.paymentStatus) + '</td>' +
                    '<td class="editable">' + sanitizeInput(record.startDate) + '</td>' +
                    '<td class="editable">' + sanitizeInput(record.amountDue) + '</td>' +
                    '<td><button class="deleteButton">Elimina</button></td>' +
                    '</tr>';

                dataTableBody.insertAdjacentHTML('beforeend', newRow);
                console.log('Nuova riga aggiunta dalla registrazione JSON:', record);
				updateRecordCount();
            });
            addEditableFunctionality();
            addDeleteFunctionality();
        } catch (error) {
            console.error('Errore durante il caricamento del file JSON:', error);
            alert('Si è verificato un errore durante il caricamento del file JSON. Controlla la console per maggiori dettagli.');
        }
    };
    reader.readAsText(file);
});

// Scarica i dati come file JSON
document.getElementById('downloadJsonButton').addEventListener('click', () => {
    try {
        console.log('Inizio download file JSON...');
        const rows = Array.from(dataTableBody.querySelectorAll('tr'));
        const data = rows.map(row => {
            const cells = row.querySelectorAll('td');
            const record = {
                id: sanitizeInput(cells[0].innerText),
                firstName: sanitizeInput(cells[1].innerText),
                lastName: sanitizeInput(cells[2].innerText),
                birthDate: sanitizeInput(cells[3].innerText),
                residence: sanitizeInput(cells[4].innerText),
                phone: sanitizeInput(cells[5].innerText),
                email: sanitizeInput(cells[6].innerText),
                licenseType: sanitizeInput(cells[7].innerText),
                courseStatus: sanitizeInput(cells[8].innerText),
                examResults: sanitizeInput(cells[9].innerText),
                paymentStatus: sanitizeInput(cells[10].innerText),
                startDate: sanitizeInput(cells[11].innerText),
                amountDue: sanitizeInput(cells[12].innerText)
            };
            console.log('Record per il download:', record);
            return record;
        });

        const jsonString = JSON.stringify(data, null, 2);
        const blob = new Blob([jsonString], { type: 'application/json' });
        const url = URL.createObjectURL(blob);

        const a = document.createElement('a');
        a.href = url;
        a.download = 'clienti_autoscuola.json';
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        console.log('Download avviato per il file:', a.download);
        URL.revokeObjectURL(url);
    } catch (error) {
        console.error('Errore durante il download del file JSON:', error);
        alert('Si è verificato un errore durante il download del file JSON. Controlla la console per maggiori dettagli.');
    }
});


// Funzione per aggiungere o sottrarre importi
function updateAmount(operation) {
    const amountDueInput = document.getElementById('amountDue');
    let currentAmount = parseFloat(amountDueInput.value);

    const amountToChange = parseFloat(document.getElementById('amountToAddSubtract').value);
    if (isNaN(amountToChange)) {
        alert('Inserisci un importo valido.');
        return;
    }

    if (operation === 'add') {
        currentAmount += amountToChange;
    } else {
        currentAmount -= amountToChange;
    }

    // Aggiorna l'input amountDue con il nuovo valore
    amountDueInput.value = currentAmount.toFixed(2);
    console.log(`Importo aggiornato: ${currentAmount.toFixed(2)}`);
}

// Aggiungi event listener per i pulsanti + e -
document.getElementById('addAmount').addEventListener('click', (e) => {
    e.preventDefault(); // Previene l'invio del modulo
    updateAmount('add');
    updateRecordCount();
});

document.getElementById('subtractAmount').addEventListener('click', (e) => {
    e.preventDefault(); // Previene l'invio del modulo
    updateAmount('subtract');
    updateRecordCount();
});












(function() {
  const isLocalhost = location.hostname === 'localhost';
  const isLocalIP = location.hostname === '127.0.0.1';
  const isFileProtocol = location.protocol === 'file:';
  const isHttps = location.protocol === 'https:';

  // Controlla se ci si trova in un ambiente non sicuro
  if (!isHttps && !isLocalhost && !isLocalIP && !isFileProtocol) {
    try {
      const newUrl = 'https:' + window.location.href.substring(window.location.protocol.length);
      location.href = newUrl; // Reindirizza a HTTPS
    } catch (error) {
      alert("Errore nel reindirizzamento: " + error);
    }
  }
})();




</script>


</body>



</html>

